---

---
購入処理を実現するために、購入テーブルに対して必要なデータを登録するための購入DAO(Purchaseクラス)を作成する。
購入DAOには、購入情報を登録する処理(insertメソッド)を設ける

### 購入情報の登録

購入情報は購入テーブルに登録する。

### purchaseDAOの作成

```java
PurchaseDAO.java
package dao;

import bean.Item;
import bean.Product;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.util.List;

public class PurchaseDAO extends DAO {
	public boolean insert(List<Item> cart, String name, String address) throws Exception {
		Connection con=getConnection();
		con.setAutoCommit(false);
		自動コミットモードの設定。自動コミットモードをオフにして、コミットやロールバックを手動で行えるようにする。

-----insert文の作成------------		
for (Item item : cart) { 現在カートに入っている種類の数だけinsert分を実行して、purchaseテーブルに行を追加する。
			PreparedStatement st=con.prepareStatement(
				"insert into purchase values(null, ?, ?, ?, ?, ?, ?)");
			Product p=item.getProduct();
			st.setInt(1, p.getId());
			st.setString(2, p.getName());
			st.setInt(3, p.getPrice());
			st.setInt(4, item.getCount());
			st.setString(5, name);
			st.setString(6, address);
			int line=st.executeUpdate(); 
			insert文を発行するexecuteUpdateメソッドは、変更した行数を返す。
			正常に更新すると１を、失敗すると0を返す。
			st.close();
-------------------------------------

------繰り返し実行されるinsert文のいずれかが失敗した場合の処理-----a
			if (line!=1) {
				con.rollback();
				con.setAutoCommit(true);
				con.close();
				return false;
			}
		}
ロールバックを実行して、自動コミットモードを有効に戻して、falseを返す
--------------------------------------

-----すべてのSQL文の実行に成功した場合の処理-------
		con.commit();
		con.setAutoCommit(true);
		con.close();
		return true;
コミットを行い、自動コミットモードを有効にして、trueを返す。
------------------------------------
	}
}
```