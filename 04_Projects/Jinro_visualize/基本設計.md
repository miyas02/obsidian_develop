---

---
# 機能一覧

| 機能ID | 大カテゴリ | 中カテゴリ  | 機能                       |
| ---- | ----- | ------ | ------------------------ |
|      | 役職    | CO     | COした役職者をRoleDashboardに表示 |
|      | 役職    | 能力     | 占い師の占い結果を表示              |
|      | 役職    | 能力     | 霊媒師の霊媒結果を表示              |
|      | 役職    | 能力     | 騎士の護衛結果を表示               |
|      | 投票    | 投票入力   | 投票結果をドラッグアンドドロップで操作できる   |
|      | 投票    | タイムライン | 日別の投票履歴の表示               |
|      | 投票    | プレイヤー  | プレイヤー別の投票履歴の表示           |
|      | 投票    | 分析レポート | 投票分析結果の表示                |

# 画面設計
# 全体フロー図

```mermaid
sequenceDiagram
    actor client
    participant server as github Pages

    client ->> server: request
    server -->> client: Blazorアプリ
    Note over client: Blazorアプリ実行
    alt phase2から
        client ->> server: 村, ユーザー管理API
        server -->> client:村, ユーザー情報
    end

```
# Class Diagram
## Role class diagram
```mermaid
classDiagram
	class Player {
		+playerId : int
		+role : Role
		+vote : Vote
		+isAlive : boolean
	}
	class RoleEnum {
		Villager
		Seer
		Medium
		BG
		Wolf
		Madman
	}
	class Role {
		<<Abstract>>
		+roleId : RoleEnum
		-roleName : string
		+isEvil : boolean
		+isWolf : boolean
	}
	class Villager {
		+roleId : RoleEnum
	}
	class Seer {
		roleId : RoleEnum
		divinationResult : List~DivinationResult~
	}
	class Medium {
		roleId : RoleEnum
		mediumResult : MediumResult
	}
	class BG {
		roleId : RoleEnum
		bgresult : BGresult
	}
	class Wolf {
		roleId : RoleEnum
		otherWolves : OtherWolves
	}
	class Madman {
		roleId : RoleEnum
	}
		class DivinationResult {
		seerOwner : Player
		divinationTarget : Player
		targetIsWolf : boolean
		divinationDay : GameDay
	}
	class MediumResult {
		mediumOwner : Player
		mediumTarget : Player
		targetIsWolf : boolean
		divinationDay : GameDay
	}
	class BGresult {
		BGOwner : Player
		BGtarget : Player
		bodyGaudisSuccess
	}
	Player *-- Role
	Role *-- RoleEnum
	Role <-- Seer
	Role <-- Villager
	Role <-- Medium
	Role <-- BG
	Role <-- Wolf
	Role <-- Madman
	Seer *-- DivinationResult
	Medium *-- MediumResult
	BG *-- BGresult
```

## Vote class diagram
```mermaid
classDiagram
	class Player {
		+votes : VoteHistory
	}
	class VoteHistory {
		-votes : List~Vote~
		+add()
		+GetForDay(GameDay)
	}
	class Vote {
		+voteId : string
		+day : GameDay
		+order : int
		+playerSource : Player
		+playerTarget : Player
	}
	VoteHistory *-- Vote
	Player *-- VoteHistory
```
# GameDay class diagram
```mermaid
classDiagram
	class DayHistory {
		+day
	}
	class GameDay {
		+dayId : int
	}
	class DiscussionTime {
	}
	class night {
	}
```
# メイン画面
## メイン画面コンポーネント class diagram
```mermaid
classDiagram
	class RoleContainer{
		-SeerComponent : SeerComponent
		-MediumComponent : MediumComponent
		-BGComponent : BGComponent 
	}
	class SeerContainer {
		-seerActors : List~Seer~
		-divinationResults : List~DivinationResults~
	}
	class MediumContainer {
		-mediumActors : List~Medium~
		-mediumResults : List~MediumResultsj~
	}
	class BGContainer {
		-bgActors : List~BGA~
		-bgResutls : List~BGResults~
	}
	class NameplateContainer {
		+nameplate : Nameplate
	}
	class Nameplate {
		
	}
	RoleContainer *-- SeerContainer
	RoleContainer *-- MediumContainer
	RoleContainer *-- BGContainer
	NameplateContainer *-- Nameplate
```

## メイン画面ワイヤーフレーム
```plantuml
@startsalt
{^ メイン画面
	{
		"RoleDashboardContainer"
		.
		.
		.
	}
	---
	{
		"NameplateContainer"
		.
		.
		.
		.
		.
	}
}
@endsalt
```
### 【メイン画面】RoleDashboardContainerワイヤーフレーム
```plantuml
@startsalt
{^ "RoleContainer"
	{^ "SeerContainer"
		{+
	        { "nameplate" } | { "result" } | { "nameplate" } | { "result" }
	    }
	    {+
		    { "nameplate" } | { "result" } | { "nameplate" } | { "result" }
	    }
	    {+
		    { "nameplate" } | { "result" } | { "nameplate" } | { "result" }
	    }
	}
	{^ "MediumContainer"
		{+
	        { "nameplate" } | {"result           "}
	    }
	    {+
		    { "nameplate" } | {"result           "}
	    }
	    {+
		    { "nameplate" } | {"result           "}
	    }
	}
	{^ "BGContainer"
		{+
	        { "nameplate" } | {"result           "}
	    }
	    {+
		    { "nameplate" } | {"result           "}
	    }
	    {+
		    { "nameplate" } | {"result           "}
	    }
	}
}
@endsalt
```
### 【メイン画面】NameplateContainer
```plantuml
@startsalt
{^"NameplateContainer"
	{+
		{"nameplate" |* status} | {"nameplate" |* status} | {"nameplate" |* status} | {"nameplate" |* status}
		{"nameplate" |* status} | {"nameplate" |* status} | {"nameplate" |* status} | {"nameplate" |* status}
		{"nameplate" |* status} | {"nameplate" |* status} | {"nameplate" |* status} | {"nameplate" |* status}
		{"nameplate" |* status} | {"nameplate" |* status} | {"nameplate" |* status}
	}
}
@endsalt
```
# 投票入力画面
```mermaid
classDiagram
	class VoteInput {
		+nameplateList : NameplateList
		+voteBoxes : VoteBoxes
		+dayList : List~GameDay~
	}
	class NameplateList {
		+playerList : List~Player~
	}
	class VoteBoxes {
		+playerList : List~Player~
	}
	VoteInput *-- NameplateList
	VoteInput *-- VoteBoxes
```
## 投票入力画面ワイヤーフレーム
```plantuml
@startsalt
{^"投票画面"
	{/ <b>1日目</b> | 2日目 | 3日目}
	{+
		{^"ネームプレートリスト"
			{ "nameplate" } | { "nameplate" }
			{ "nameplate" } | { "nameplate" }
			{ "nameplate" } | { "nameplate" }
			{ "nameplate" } | { "nameplate" }
			{ "nameplate" } | { "nameplate" }
			{ "nameplate" } | { "nameplate" }
			{ "nameplate" } | { "nameplate" }
			{ "nameplate" }
		} | {^"投票ボックス"
			{[1投票者]|[被投票者]}
			{[2投票者]|[被投票者]} | {[3投票者]|[被投票者]}
			{[4投票者]|[被投票者]} | {[5投票者]|[被投票者]}
			{[6投票者]|[被投票者]} | {[7投票者]|[被投票者]}
			{[8投票者]|[被投票者]} | {[9投票者]|[被投票者]}
			{[10投票者]|[被投票者]} | {[11投票者]|[被投票者]}
			{[12投票者]|[被投票者]} | {[13投票者]|[被投票者]}
			{[14投票者]|[被投票者]} | {[15投票者]|[被投票者]}
		}
	}
}
@endsalt
```
# 投票結果画面
##  投票結果画面ワイヤーフレーム
```plantuml
@startsalt
{
	{/ <b>タイムライン投票履歴</b> | プレイヤー投票履歴 | 分析レポート }
	{^"投票履歴"
		{
			{^"Day 1"
				処刑: <b>Susan</b>
				---
				{. 
				   Su -> Mi | To -> Su
				   Mi -> Su | An -> Su
				   Ma -> Su | Bo -> Jo } 
				}
				|
				{^"Day 2"
					処刑: <b>Bob</b>
					---
					{. 
					   Mi -> Bo | An -> Bo
					   Ma -> Bo | Jo -> Bo
					}
				}
				|
				{^"Day 3"
					<b>襲撃により終了</b>
					--- GMからのメッセージ
					. 
				}
			}
		}
	}
}


@endsalt
```
```plantuml
@startsalt
{
  {/ タイムライン投票履歴 | <b>プレイヤー投票履歴</b> | 分析レポート  }
  {^"プレイヤー別投票マトリクス"
    {#
      <b>Player</b> | <b>Day 1</b> | <b>Day 2</b> | <b>Day 3</b>
      Susan    | -> Mike   | .          | .
      Mike     | -> Susan  | -> Bob     | .
      Tom      | -> Susan  | -> Bob     | -> Anna
      Anna     | -> Susan  | -> Bob     | -> Tom
      Mary     | -> Susan  | -> Bob     | -> Tom
      Bob      | -> John   | -> John    | .
      John     | -> Bob    | -> Bob     | -> Anna
    }
    "※ . は死亡または見学"
  }
}
@endsalt
```
```plantuml
@startsalt
{
  {/ 日別結果 | プレイヤー履歴 | <b>分析レポート</b> }
  {
    {^"① 被投票数（ヘイト値）累積"
      {
         <b>Susan</b> | [||||||||||||] 8票
         <b>Mike</b>  | [||||||....] 4票
         <b>Tom</b>   | [|||.......] 2票
      }
      "※ 過去にどれだけ疑われたかの合計"
    }
    |
    {^"② 投票シンクロ率（ペア分析）"
      {
        <b>Mike & Anna</b> | [||||||||||] 100% (3/3)
        <b>Tom & Mary</b>  | [|||||||...] 66% (2/3)
        <b>Bob & John</b>  | [||||......] 33% (1/3)
      }
      "※ 同じ相手に投票した割合"
    }
  }
  ---
  {^"③ 推定ライン（同陣営の可能性）"
    {
      <b>グループA (投票先が常に一致)</b>
      .
      { (O) <b>Mike</b> | (O) <b>Anna</b> }
      .
      "考察: 狼同士のライン、または狂信者？"
    }
    |
    {
       <b>グループB (相互投票の関係)</b>
       .
       { (X) <b>Susan</b> | <-> | (X) <b>Tom</b> }
       .
       "考察: 敵対関係。身内切りの可能性もあり"
    }
  }
}
@endsalt
```
